{# Vue pour afficher un article avec ses commentaires #}
{% extends 'layout.html.twig' %}

{% block title %}Article{% endblock %}

{% block content %}
    <h1>{{ article.title }}</h1>
    <p>{{ article.content }}</p>

    <h2>Commentaires</h2>
    {% if comments is not empty %}
        <ul>
            {% for comment in comments %}
    <li>
        <strong>Utilisateur:</strong> {{ comment.user_name }}<br>
        <p>{{ comment.content }}</p>
        {% if "user_id" is defined %}
            <form method="post" action="/comment/delete">
                <input type="hidden" name="comment_id" value="{{ comment.id }}">
                <input type="hidden" name="article_id" value="{{ article_id }}"> 
                <button type="submit">Supprimer le commentaire</button>
            </form>
        {% endif %}
    </li>
{% endfor %}
        </ul>
    {% else %}
        <p>Aucun commentaire pour cet article.</p>
    {% endif %}

    {# Formulaire pour ajouter un commentaire #}
    {% if "user_id" is defined %}
        <h3>Laissez un commentaire</h3>
        <form method="post" action="/comment/add">
            <input type="hidden" name="article_id" value="{{ article.id }}">
            <textarea name="content" required placeholder="Votre commentaire..."></textarea>
            <button type="submit">Ajouter un commentaire</button>
        </form>
    {% else %}
        <p>Vous devez être connecté pour poster un commentaire. <a href="/login">Se connecter</a></p>
    {% endif %}
{% endblock %}
